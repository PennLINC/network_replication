annotate(geom="text", x=290, y=0.055, label=r_text, color="black"))
ggsave(schaefer400_SA.AgeEffect, file="/cbica/projects/network_replication/adapted_Rscripts/Figures/Schaefer400/BNC/schaefer400x17_SA.AgeEffect.pdf", width = 5, height=4, dpi=300)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x7_regionlist.csv", header = T)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = T)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
schaefer200x7.parcel.labels
cbind(schaefer200x7.parcel.labels, schaefer200x17.parcel.labels)
schaefer200x17.parcel.labels
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
cbind(schaefer200x7.parcel.labels, schaefer200x17.parcel.labels)
as.matrix(cbind(schaefer200x7.parcel.labels, schaefer200x17.parcel.labels))
index_schaefer200x7to17 <- read.csv("/Users/audluo/Desktop/index_schaefer200x7to17.csv")
index_schaefer200x7to17
index_schaefer200x7to17 <- read.csv("/Users/audluo/Desktop/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17
schaefer200x7.parcel.labels
schaefer200x7.parcel.labels$V1
View(index_schaefer200x7to17)
schaefer200x7.parcel.labels$V1[index_schaefer200x7to17]
index_schaefer200x7to17 <- as.vector(index_schaefer200x7to17)
index_schaefer200x7to17
c(index_schaefer200x7to17)
index_schaefer200x7to17 <- c(index_schaefer200x7to17)
schaefer200x7.parcel.labels$V1[index_schaefer200x7to17]
schaefer200x7.parcel.labels$V1[c(index_schaefer200x7to17)]
schaefer200x7.parcel.labels$V1[c(1)]
schaefer200x7.parcel.labels
schaefer200x7.parcel.labels$V1[index_schaefer200x7to17]
index <- c(1, 2, 3)
schaefer200x7.parcel.labels$V1[index]
index_schaefer200x7to17
class(index_schaefer200x7to17)
unlist(index_schaefer200x7to17)
index_schaefer200x7to17
as.vector(index_schaefer200x7to17)
class(index_schaefer200x7to17)
class(index_schaefer200x7to17$V1)
class(index)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
index_schaefer200x7to17$V1
schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels)
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
schaefer400x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer400_7Network_regionlist.csv", header = F)
schaefer400x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer400x17_regionlist.csv", header = T)
schaefer400x7.parcel.labels
schaefer400x17.parcel.labels
index_schaefer400x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer400x7to17.csv", header=F)
index_schaefer400x7to17$V1 <- as.numeric(index_schaefer400x7to17$V1)
schaefer400x7_reordered <-schaefer400x7.parcel.labels$V1[index_schaefer400x7to17$V1]
as.matrix(cbind(schaefer400x7_reordered, schaefer400x17.parcel.labels))
write.csv(schaefer400x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer400_7Network_regionlist_reordered.csv")
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
SNRmask_schaefer200x17 <- read.csv("/Users/audluo/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer200x17.csv")
SNRmask_schaefer200x7 <- read.csv("/Users/audluo/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer200x7.csv")
SNRmask_schaefer200x7
SNRmask_schaefer200x17
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
identical(SNRmask_schaefer200x17, SNRmask_schaefer200x7)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
setdiff(SNRmask_schaefer200x17, SNRmask_schaefer200x7)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
setdiff(SNRmask_schaefer200x17$SNR.mask, SNRmask_schaefer200x7$SNR.mask)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
identical(SNRmask_schaefer200x17$SNR.mask, SNRmask_schaefer200x7$SNR.mask)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
class(v)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
class(SNRmask_schaefer200x17$SNR.mask)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
class(SNRmask_schaefer200x7$SNR.mask)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
cbind(SNRmask_schaefer200x17$SNR.mask, SNRmask_schaefer200x7$SNR.mask)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
SNRmask_schaefer200x7$SNR.mask
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
which(SNRmask_schaefer200x7$SNR.mask == 0)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
SNRmask_schaefer400x17 <- read.csv("/Users/audluo/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer400x17.csv")
SNRmask_schaefer400x7 <- read.csv("/Users/audluo/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer400x7.csv")
cbind(SNRmask_schaefer400x17$SNR.mask, SNRmask_schaefer400x7$SNR.mask)
# can try original 400x7 SNR mask on original 400x7 ordering, then compare to 400x17 SNR mask on 400x7 reordered
which(SNRmask_schaefer400x7$SNR.mask == 0)
which(SNRmask_schaefer400x7$SNR.mask == 0)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
schaefer400x7.parcel.labels[which(SNRmask_schaefer400x7$SNR.mask == 0)]
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
schaefer400x7.parcel.labels$V1[which(SNRmask_schaefer400x7$SNR.mask == 0)]
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
schaefer400x7_reordered$V1[which(SNRmask_schaefer400x7$SNR.mask == 0)]
schaefer400x7_reordered
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
SNRmask_schaefer400x17$SNR.mask
schaefer400x7_reordered[which(SNRmask_schaefer400x17$SNR.mask == 0)]
schaefer400x7.parcel.labels$V1[which(SNRmask_schaefer400x7$SNR.mask == 0)]
schaefer400x7_reordered[which(SNRmask_schaefer400x17$SNR.mask == 0)]
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
x <- schaefer400x7.parcel.labels$V1[which(SNRmask_schaefer400x7$SNR.mask == 0)]
y <- schaefer400x7_reordered[which(SNRmask_schaefer400x17$SNR.mask == 0)]
identical(x,y)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
setdiff(x,y)
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = F)
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
# want to put schaefer200x7 in the same order as schaefer200x17
# then i think i can do the SNR mask? and other stuff?
index_schaefer200x7to17 <- read.csv("/cbica/projects/network_replication/software/schaefer7to17_reordering/index_schaefer200x7to17.csv", header=F)
index_schaefer200x7to17$V1 <- as.numeric(index_schaefer200x7to17$V1)
schaefer200x7_reordered <-schaefer200x7.parcel.labels$V1[index_schaefer200x7to17$V1]
as.matrix(cbind(schaefer200x7_reordered, schaefer200x17.parcel.labels))
#write.csv(schaefer200x7_reordered, "/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv")
cbind(x,y)
schaefer200x7_communityAffil <- read.csv("/Users/audluo/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D.csv")
schaefer200x7_communityAffil
schaefer200x7_communityAffil
schaefer200x7_communityAffil
schaefer200x7_communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D.csv")
schaefer200x7_communityAffil
schaefer200x7_communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D.csv", header=F)
schaefer200x7_communityAffil
schaefer200x7_communityAffil
schaefer200x7_communityAffil
View(schaefer200x7_communityAffil)
str(schaefer200x7_communityAffil)
schaefer200x7_communityAffil_reordered <-schaefer200x7_communityAffil$V1[index_schaefer200x7to17$V1]
schaefer200x7_communityAffil_reordered
cbind(schaefer200x7_communityAffil_reordered, schaefer200x7_communityAffil)
knitr::opts_chunk$set(echo = TRUE)
library(ciftiTools)
ciftiTools.setOption('wb_path', '/Applications/workbench/')
library(gifti)
library(cifti)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggseg)
library(ggsegExtra)
library(ggsegGlasser)
library(ggsegSchaefer)
library(viridis)
require(ggplot2)
library(dplyr)
rownames(schaefer200x7_commAffil_mat) <- NULL
1+2
schaefer200x7_communityAffil_reordered
cbind(schaefer200x7_communityAffil_reordered, schaefer200x7_communityAffil)
as.matrix(cbind(schaefer200x7_communityAffil_reordered, schaefer200x7_communityAffil))
write.csv(schaefer200x7_communityAffil_reordered, "/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv")
# reorder community affiliation
schaefer400x7_communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer400x7CommunityAffiliation.1D.csv", header=F)
schaefer400x7_communityAffil
schaefer400x7_communityAffil_reordered <-schaefer400x7_communityAffil$V1[index_schaefer400x7to17$V1]
as.matrix(cbind(schaefer400x7_communityAffil_reordered, schaefer400x7_communityAffil))
write.csv(schaefer400x7_communityAffil_reordered, "/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer400x7CommunityAffiliation.1D_reordered.csv")
as.matrix(cbind(schaefer400x7_communityAffil_reordered, schaefer400x7_reordered))
as.matrix(cbind(schaefer400x7_communityAffil, schaefer400x7.parcel.labels))
as.matrix(cbind(schaefer400x7_communityAffil, schaefer400x7.parcel.labels))
as.matrix(cbind(schaefer400x7_communityAffil_reordered, schaefer400x7_communityAffil))
as.matrix(cbind(schaefer400x7_communityAffil_reordered, schaefer400x7_reordered))
knitr::opts_chunk$set(echo = TRUE)
library(ciftiTools)
ciftiTools.setOption('wb_path', '/Applications/workbench/')
library(gifti)
library(cifti)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggseg)
library(ggsegExtra)
library(ggsegGlasser)
library(ggsegSchaefer)
library(viridis)
require(ggplot2)
library(dplyr)
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
names(schaefer200.parcel.labels)[2] <- "label"
#  make dataframe where rownames are the commAffil number, and then need to transpose V1 to be rows
schaefer200x7_rows <- as.data.frame(t(schaefer200.parcel.labels$network))
schaefer200.parcel.labels
schaefer200.parcel.labelsfasdfa <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist.csv", header = T)
schaefer200.parcel.labelsfasdfa
schaefer200.parcel.labels
commAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv")
commAffil
cbind(schaefer200.parcel.labels$label, commAffil$x)
as.data.frame(cbind(schaefer200.parcel.labels$label, commAffil$x))
schaefer200.parcel.labels
knitr::opts_chunk$set(echo = TRUE)
library(ciftiTools)
ciftiTools.setOption('wb_path', '/Applications/workbench/')
library(gifti)
library(cifti)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggseg)
library(ggsegExtra)
library(ggsegGlasser)
library(ggsegSchaefer)
library(viridis)
require(ggplot2)
library(dplyr)
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
schaefer200.communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_17Network/schaefer200x7CommunityAffiliation.1D_reordered.csv", header=F)
schaefer200.communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv", header=F)
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
schaefer200.communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv", header=F)
schaefer200.parcel.labels <- as.data.frame(cbind(schaefer200.parcel.labels$x, schaefer200.communityAffil$V1))
schaefer200.parcel.labels
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = F)
schaefer200.parcel.labels
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = F)
schaefer200.parcel.labels
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
schaefer200.parcel.labels
schaefer200.communityAffil
schaefer200.communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv", header=T)
schaefer200.communityAffil
schaefer200.parcel.labels
schaefer200.parcel.labels <- as.data.frame(cbind(schaefer200.parcel.labels$x, schaefer200.communityAffil$x))
schaefer200.parcel.labels
names(schaefer200.parcel.labels) <- c("label", "network")
schaefer200.parcel.labels
schaefer200x7_rows <- as.data.frame(t(schaefer200.parcel.labels$network))
schaefer200x7_commAffil_mat <- as.data.frame(schaefer200x7_rows[rep(seq_len(nrow(schaefer200x7_rows)), each = 200), ])
rownames(schaefer200x7_commAffil_mat) <- NULL
schaefer200x7_commAffil_mat
SNRmask_schaefer200x7 <- read.csv('/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer200x7_reordered.csv') # this is just the SNRmask for schaefer200x17
# computeBNC(rbcid, "schaefer200", schaefer200x7_commAffil_mat, schaefer200.parcel.labels$network)
computeBNC <- function(rbcid, atlas, community_affiliation_mat, network_assignment){
#read in connectivity matrix
if(atlas == "schaefer200"){
connect.matrix <- read_cifti(sprintf("/cbica/projects/network_replication/pconn/%1$s/%1$s_ses-PNC1_task-rest_acq-singleband_space-fsLR_atlas-Schaefer217_den-91k_den-91k_bold.pconn.nii",rbcid))
mask <- SNRmask_schaefer200x7} #200 x 200 matrix
# set rows and columns corresponding to parcel # in mask to NA
connect.matrix$data[which(mask == 0), ] <- NA
connect.matrix$data[,which(mask == 0)] <- NA
#compute average between-network connectivity
BNC <- c()
for (i in 1:nrow(connect.matrix$data)) {
between_network_values <- c()
BNC_per_node <- c()
for (j in 1:length(connect.matrix$data[i,])) {  # entire  row
if(is.na(connect.matrix$data[i,j]) || connect.matrix$data[i,j] == 1) { # add NA if excluded by mask or identity
between_network_values <- append(between_network_values, NA);
} else if (schaefer200.parcel.labels$network[i] != schaefer200x7_commAffil_mat[i,j]) {
between_network_values <- append(between_network_values, connect.matrix$data[i,j])
} else if (schaefer200.parcel.labels$network[i] == schaefer200x7_commAffil_mat[i,j]) {
between_network_values <- append(between_network_values, NA)
}
}
#print(between_network_values)
BNC_per_node <- append(BNC_per_node, mean(between_network_values, na.rm=TRUE))
#print(BNC_per_node) # 1 value
BNC <- append(BNC, BNC_per_node)
}
return(BNC)
}
participants <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/participants_allIDs.csv')
subs_no_files <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/subs_no_files.csv', row.names=NULL)
subs_no_files <- subs_no_files[,2]
BNC.subxparcel.matrix.schaefer200 <- matrix(data = NA, nrow = nrow(participants), ncol = 201)
regionheaders <- as.character(schaefer200.parcel.labels$label)
demoheaders <- c("rbcid")
colheaders <- as.matrix(c(demoheaders,regionheaders))
colnames(BNC.subxparcel.matrix.schaefer200) <- colheaders
#compute BNC for each subject
for(sub in c(1:nrow(participants))){
rbcid=as.character(participants[sub,4])
if(rbcid %in% subs_no_files){
next
}
else {
rbcid.data.schaefer200 <- computeBNC(rbcid, "schaefer200", schaefer200x7_commAffil_mat, schaefer200.parcel.labels$network)
BNC.subxparcel.matrix.schaefer200[sub,] <- cbind(rbcid, t(rbcid.data.schaefer200))
print(paste(sub, rbcid, "schaefer200"))
}
}
participants <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/participants_allIDs.csv')
subs_no_files <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/subs_no_files.csv', row.names=NULL)
subs_no_files <- subs_no_files[,2]
BNC.subxparcel.matrix.schaefer200 <- matrix(data = NA, nrow = nrow(participants), ncol = 201)
regionheaders <- as.character(schaefer200.parcel.labels$label)
demoheaders <- c("rbcid")
colheaders <- as.matrix(c(demoheaders,regionheaders))
colnames(BNC.subxparcel.matrix.schaefer200) <- colheaders
#compute BNC for each subject
for(sub in c(1:nrow(participants))){
rbcid=as.character(participants[sub,4])
if(rbcid %in% subs_no_files){
next
}
else {
rbcid.data.schaefer200 <- computeBNC(rbcid, "schaefer200", schaefer200x7_commAffil_mat, schaefer200.parcel.labels$network)
BNC.subxparcel.matrix.schaefer200[sub,] <- cbind(rbcid, t(rbcid.data.schaefer200))
print(paste(sub, rbcid, "schaefer200"))
}
}
knitr::opts_chunk$set(echo = TRUE)
library(ciftiTools)
ciftiTools.setOption('wb_path', '/Applications/workbench/')
library(gifti)
library(cifti)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggseg)
library(ggsegExtra)
library(ggsegGlasser)
library(ggsegSchaefer)
library(viridis)
require(ggplot2)
library(dplyr)
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200_7Network_regionlist_reordered.csv", header = T)
schaefer200.communityAffil <- read.csv("/cbica/projects/network_replication/atlases/parcellations/Schaefer_7Network/schaefer200x7CommunityAffiliation.1D_reordered.csv", header=T)
schaefer200.parcel.labels <- as.data.frame(cbind(schaefer200.parcel.labels$x, schaefer200.communityAffil$x))
names(schaefer200.parcel.labels) <- c("label", "network")
#  make dataframe where rownames are the commAffil number, and then need to transpose V1 to be rows
schaefer200x7_rows <- as.data.frame(t(schaefer200.parcel.labels$network))
schaefer200x7_commAffil_mat <- as.data.frame(schaefer200x7_rows[rep(seq_len(nrow(schaefer200x7_rows)), each = 200), ])
rownames(schaefer200x7_commAffil_mat) <- NULL
SNRmask_schaefer200x7 <- read.csv('/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer200x7_reordered.csv') # this is just the SNRmask for schaefer200x17
# computeBNC(rbcid, "schaefer200", schaefer200x7_commAffil_mat, schaefer200.parcel.labels$network)
computeBNC <- function(rbcid, atlas, community_affiliation_mat, network_assignment){
#read in connectivity matrix
if(atlas == "schaefer200"){
connect.matrix <- read_cifti(sprintf("/cbica/projects/network_replication/pconn/%1$s/%1$s_ses-PNC1_task-rest_acq-singleband_space-fsLR_atlas-Schaefer217_den-91k_den-91k_bold.pconn.nii",rbcid))
mask <- SNRmask_schaefer200x7} #200 x 200 matrix
# set rows and columns corresponding to parcel # in mask to NA
connect.matrix$data[which(mask == 0), ] <- NA
connect.matrix$data[,which(mask == 0)] <- NA
#compute average between-network connectivity
BNC <- c()
for (i in 1:nrow(connect.matrix$data)) {
between_network_values <- c()
BNC_per_node <- c()
for (j in 1:length(connect.matrix$data[i,])) {  # entire  row
if(is.na(connect.matrix$data[i,j]) || connect.matrix$data[i,j] == 1) { # add NA if excluded by mask or identity
between_network_values <- append(between_network_values, NA);
} else if (schaefer200.parcel.labels$network[i] != schaefer200x7_commAffil_mat[i,j]) {
between_network_values <- append(between_network_values, connect.matrix$data[i,j])
} else if (schaefer200.parcel.labels$network[i] == schaefer200x7_commAffil_mat[i,j]) {
between_network_values <- append(between_network_values, NA)
}
}
#print(between_network_values)
BNC_per_node <- append(BNC_per_node, mean(between_network_values, na.rm=TRUE))
#print(BNC_per_node) # 1 value
BNC <- append(BNC, BNC_per_node)
}
return(BNC)
}
participants <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/participants_allIDs.csv')
subs_no_files <- read.csv('/cbica/projects/network_replication/adapted_Rscripts/subs_no_files.csv', row.names=NULL)
subs_no_files <- subs_no_files[,2]
BNC.subxparcel.matrix.schaefer200 <- matrix(data = NA, nrow = nrow(participants), ncol = 201)
regionheaders <- as.character(schaefer200.parcel.labels$label)
demoheaders <- c("rbcid")
colheaders <- as.matrix(c(demoheaders,regionheaders))
colnames(BNC.subxparcel.matrix.schaefer200) <- colheaders
#compute BNC for each subject
for(sub in c(1:nrow(participants))){
rbcid=as.character(participants[sub,4])
if(rbcid %in% subs_no_files){
next
}
else {
rbcid.data.schaefer200 <- computeBNC(rbcid, "schaefer200", schaefer200x7_commAffil_mat, schaefer200.parcel.labels$network)
BNC.subxparcel.matrix.schaefer200[sub,] <- cbind(rbcid, t(rbcid.data.schaefer200))
print(paste(sub, rbcid, "schaefer200"))
}
}
x <- read_cifti("/cbica/projects/network_replication/pconn/sub-3885398873/sub-3885398873_ses-PNC1_task-rest_acq-singleband_space-fsLR_atlas-Schaefer217_den-91k_den-91k_bold.pconn.nii")
