source("./3_GAM_functions.R")
source("/cbica/projects/network_replication/adapted_Rscripts/GAM_functions.R")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
#source("./3_GAM_functions.R")
source("/cbica/projects/network_replication/adapted_Rscripts/GAM_functions.R")
participants <- read.csv("participants_allIDs.csv") #final study sample pnc IDs (bblid/scanid) from Adam Pines's multiscale paper
demographics <- read.csv("/cbica/projects/network_replication/PNC/n1601_demographics_go1_20161212.csv") #PNC demographics information
demographics <- demographics %>% mutate(age = (ageAtScan1/12)) #format age variable
demographics$sex <- as.factor(demographics$sex) #format sex variable
demographics <- merge(participants, demographics, by="scanid") #get demographics for final study sample only via ID matching
relRMS <- read.csv("/cbica/projects/network_replication/PNC/qc_files/RBC_PNC_relMeans.csv")
demographics <- merge(demographics, relRMS, by="rbcid") #add motion information to demographics df
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
# load SNR mask
SNRmask_schaefer200 <- read.csv('/cbica/projects/network_replication/atlases/Masks/SNRmask_schaefer200x17.csv')
# load region list
schaefer200.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist.csv", header = T)
names(schaefer200.parcel.labels) <- c("orig_parcelname", "label")
schaefer200.parcel.labels[which(SNRmask_schaefer200 == 0),] <- NA # apply SNR mask to parcel names
schaefer200.parcel.labels <- na.omit(schaefer200.parcel.labels)
# load parcellated SA axis
schaefer200_SAaxis_cifti <- read_cifti("/cbica/projects/network_replication/SAaxis/SensorimotorAssociation_Axis_parcellated/SensorimotorAssociation.Axis.Schaefer200.17Networks.pscalar.nii")
schaefer200_SAaxis <- as.data.frame(cbind(rank(schaefer200_SAaxis_cifti$data), names(schaefer200_SAaxis_cifti$Parcel)))
colnames(schaefer200_SAaxis) <- c("SA.axis_rank","label")
# apply SNR mask
schaefer200_SAaxis[which(SNRmask_schaefer200 == 0),] <- NA
schaefer200_SAaxis <- na.omit(schaefer200_SAaxis)
gam.gbc.age.schaefer200 <- read.csv("/cbica/projects/network_replication/GBC/GAM/GAMresults.GBC.age.schaefer200x17.csv")
gam.gbc.age.schaefer200 <- gam.gbc.age.schaefer200 %>% select(-label)
gam.gbc.age.schaefer200$label <- schaefer200_SAaxis$label
df.list <- list(schaefer200_SAaxis,gam.gbc.age.schaefer200)
gbc.axis <- Reduce(function(x,y) merge(x,y, all=TRUE, sort=F), df.list)
gbc.axis$SA.axis_rank <- as.numeric(gbc.axis$SA.axis_rank)
gbc.axis
attach(gbc.axis)
gbc.axis[order(SA.axis_rank),]
gbc.axis[order(SA.axis_rank),1]
