names(BNC.schaefer200x17.PNC) <- gsub("X17", "", names(BNC.schaefer200x17.PNC))
BNC.schaefer400x7.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/BNC/BNCschaefer400x7_demographics_finalsample.csv", dataset))
names(BNC.schaefer400x7.PNC) <- gsub("X7", "", names(BNC.schaefer400x7.PNC))
BNC.schaefer400x17.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/BNC/BNCschaefer400x17_demographics_finalsample.csv", dataset))
names(BNC.schaefer400x17.PNC) <- gsub("X17", "", names(BNC.schaefer400x17.PNC))
# WNC
WNC.gordon.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/WNC/WNCgordon_demographics_finalsample.csv", dataset))
WNC.schaefer200x7.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/WNC/WNCschaefer200x7_demographics_finalsample.csv", dataset))
names(WNC.schaefer200x7.PNC) <- gsub("X7", "", names(WNC.schaefer200x7.PNC))
WNC.schaefer200x17.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/WNC/WNCschaefer200x17_demographics_finalsample.csv", dataset))
names(WNC.schaefer200x17.PNC) <- gsub("X17", "", names(WNC.schaefer200x17.PNC))
WNC.schaefer400x7.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/WNC/WNCschaefer400x7_demographics_finalsample.csv", dataset))
names(WNC.schaefer400x7.PNC) <- gsub("X7", "", names(WNC.schaefer400x7.PNC))
WNC.schaefer400x17.PNC <- read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/WNC/WNCschaefer400x17_demographics_finalsample.csv", dataset))
names(WNC.schaefer400x17.PNC) <- gsub("X17", "", names(WNC.schaefer400x17.PNC))
#not doing edge-wise sensitivity analysis for now
#edge.gordon.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/gordon_demographics_finalsample.RData")
#edge.glasser.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/glasser_demographics_finalsample.RData")
#edge.schaefer200x7.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/schaefer200x7_demographics_finalsample.RData")
#edge.schaefer200x17.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/schaefer200x17_demographics_finalsample.RData")
#edge.schaefer400x7.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/schaefer400x7_demographics_finalsample.RData")
#edge.schaefer400x17.PNC <- readRDS("/cbica/projects/network_replication/output/PNC/edge/schaefer400x17_demographics_finalsample.RData")
# make sex a factor
GBC.glasser.PNC$sex <- as.factor(GBC.glasser.PNC$sex)
GBC.gordon.PNC$sex <- as.factor(GBC.gordon.PNC$sex)
GBC.schaefer200.PNC$sex <- as.factor(GBC.schaefer200.PNC$sex)
GBC.schaefer400.PNC$sex <- as.factor(GBC.schaefer400.PNC$sex)
BNC.gordon.PNC$sex <- as.factor(BNC.gordon.PNC$sex)
BNC.schaefer200x7.PNC$sex <- as.factor(BNC.schaefer200x7.PNC$sex)
BNC.schaefer200x17.PNC$sex <- as.factor(BNC.schaefer200x17.PNC$sex)
BNC.schaefer400x7.PNC$sex <- as.factor(BNC.schaefer400x7.PNC$sex)
BNC.schaefer400x17.PNC$sex <- as.factor(BNC.schaefer400x17.PNC$sex)
WNC.gordon.PNC$sex <- as.factor(WNC.gordon.PNC$sex)
WNC.schaefer200x17.PNC$sex <- as.factor(WNC.schaefer200x17.PNC$sex)
WNC.schaefer400x17.PNC$sex <- as.factor(WNC.schaefer400x17.PNC$sex)
WNC.schaefer200x7.PNC$sex <- as.factor(WNC.schaefer200x7.PNC$sex)
WNC.schaefer400x7.PNC$sex <- as.factor(WNC.schaefer400x7.PNC$sex)
names(GBC.glasser.PNC)
#edge.gordon.PNC$sex <- as.factor(edge.gordon.PNC$sex)
#edge.glasser.PNC$sex <- as.factor(edge.glasser.PNC$sex)
#edge.schaefer200x7.PNC$sex <- as.factor(edge.schaefer200x7.PNC$sex)
#edge.schaefer200x17.PNC$sex <- as.factor(edge.schaefer200x17.PNC$sex)
#edge.schaefer400x7.PNC$sex <- as.factor(edge.schaefer400x7.PNC$sex)
#edge.schaefer400x17.PNC$sex <- as.factor(edge.schaefer400x17.PNC$sex)
# load parcel labels
glasser.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/glasser360_regionlist_final.csv")
gordon.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/gordon_regionlist_final.csv")
schaefer200x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x7_regionlist_final.csv")
schaefer200x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer200x17_regionlist_final.csv")
schaefer200.parcel.labels <- schaefer200x17.parcel.labels #gbc
schaefer400x7.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer400x7_regionlist_final.csv")
schaefer400x17.parcel.labels <- read.csv("/cbica/projects/network_replication/atlases/parcellations/schaefer400x17_regionlist_final.csv")
schaefer400.parcel.labels <- schaefer400x17.parcel.labels #gbc
# edges
#gordon_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/gordon_edge.csv")
#gordon_edge <- gordon_edge[,2]
#glasser_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/glasser_edge.csv")
#glasser_edge <- glasser_edge[,2]
#schaefer200x7_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/schaefer200x7_edge.csv")
#schaefer200x7_edge <- schaefer200x7_edge[,2]
#schaefer200x17_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/schaefer200x17_edge.csv")
#schaefer200x17_edge <- schaefer200x17_edge[,2]
#schaefer400x7_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/schaefer400x7_edge.csv")
#schaefer400x7_edge <- schaefer400x7_edge[,2]
#schaefer400x17_edge <- read.csv("/cbica/projects/network_replication/atlases/edge/schaefer400x17_edge.csv")
#schaefer400x17_edge <- schaefer400x17_edge[,2]
main <- read.csv("/Users/audluo/cbica/projects/network_replication/output/PNC/GBC/GAM/GAMresults.GBC.age.glasser.csv")
sens <- read.csv("/Users/audluo/cbica/projects/network_replication/output/PNC/sensitivity_analyses/GBC/GAM/GAMresults.GBC.age.glasser.csv")
main
sens
# GBC GAMs
gam.GBC.smooths.glasser <- estimate_GAMsmooths(glasser.parcel.labels, "GBC", "glasser", "",dataset)
gam.GBC.smooths.gordon <- estimate_GAMsmooths(gordon.parcel.labels, "GBC", "gordon", "", dataset)
gam.GBC.smooths.schaefer200 <- estimate_GAMsmooths(schaefer200x17.parcel.labels, "GBC", "schaefer200", "", dataset)
gam.GBC.smooths.schaefer400 <- estimate_GAMsmooths(schaefer400x17.parcel.labels, "GBC", "schaefer400", "", dataset)
# BNC GAMs
gam.BNC.smooths.gordon <- estimate_GAMsmooths(gordon.parcel.labels, "BNC", "gordon", "", dataset)
gam.BNC.smooths.schaefer200x7 <- estimate_GAMsmooths(schaefer200x7.parcel.labels, "BNC", "schaefer200", "x7", dataset)
gam.BNC.smooths.schaefer200x17 <- estimate_GAMsmooths(schaefer200x17.parcel.labels, "BNC", "schaefer200", "x17",dataset)
gam.BNC.smooths.schaefer400x7 <- estimate_GAMsmooths(schaefer400x7.parcel.labels, "BNC", "schaefer400", "x7",dataset)
gam.BNC.smooths.schaefer400x17 <- estimate_GAMsmooths(schaefer400x17.parcel.labels, "BNC", "schaefer400", "x17",dataset)
# WNC GAMs
gam.WNC.smooths.gordon <- estimate_GAMsmooths(gordon.parcel.labels, "WNC", "gordon", "", dataset)
gam.WNC.smooths.schaefer200x7 <- estimate_GAMsmooths(schaefer200x7.parcel.labels, "WNC", "schaefer200", "x7", dataset)
gam.WNC.smooths.schaefer200x17 <- estimate_GAMsmooths(schaefer200x17.parcel.labels, "WNC", "schaefer200", "x17",dataset)
gam.WNC.smooths.schaefer400x7 <- estimate_GAMsmooths(schaefer400x7.parcel.labels, "WNC", "schaefer400", "x7",dataset)
gam.WNC.smooths.schaefer400x17 <- estimate_GAMsmooths(schaefer400x17.parcel.labels, "WNC", "schaefer400", "x17",dataset)
# GBC GAMs age derivatives
gam.GBC.derivatives.glasser <- dev_derivatives(glasser.parcel.labels, "GBC", "glasser", dataset)
gam.GBC.derivatives.gordon <- dev_derivatives(gordon.parcel.labels, "GBC", "gordon", dataset)
gam.GBC.derivatives.schaefer200 <- dev_derivatives(schaefer200x17.parcel.labels, "GBC", "schaefer200", dataset)
gam.GBC.derivatives.schaefer400 <- dev_derivatives(schaefer400x17.parcel.labels, "GBC", "schaefer400", dataset)
# BNC GAMs age derivatives
gam.BNC.derivatives.gordon <- dev_derivatives(gordon.parcel.labels, "BNC", "gordon", dataset)
gam.BNC.derivatives.schaefer200x7 <- dev_derivatives(schaefer200x7.parcel.labels, "BNC", "schaefer200x7", dataset)
gam.BNC.derivatives.schaefer200x17 <- dev_derivatives(schaefer200x17.parcel.labels, "BNC", "schaefer200x17", dataset)
gam.BNC.derivatives.schaefer400x7 <- dev_derivatives(schaefer400x7.parcel.labels, "BNC", "schaefer400x7", dataset)
gam.BNC.derivatives.schaefer400x17 <- dev_derivatives(schaefer400x17.parcel.labels, "BNC", "schaefer400x17", dataset)
# WNC GAMs age derivatives
gam.WNC.derivatives.gordon <- dev_derivatives(gordon.parcel.labels, "WNC", "gordon", dataset)
gam.WNC.derivatives.schaefer200x7 <- dev_derivatives(schaefer200x7.parcel.labels, "WNC", "schaefer200x7", dataset)
gam.WNC.derivatives.schaefer200x17 <- dev_derivatives(schaefer200x17.parcel.labels, "WNC", "schaefer200x17",dataset)
gam.WNC.derivatives.schaefer400x7 <- dev_derivatives(schaefer400x7.parcel.labels, "WNC", "schaefer400x7", dataset)
gam.WNC.derivatives.schaefer400x17 <- dev_derivatives(schaefer400x17.parcel.labels, "WNC", "schaefer400x17", dataset)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('PNC_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/DevEffect_Figures.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "PNC"
glasser_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/glasser_SAaxis.csv")
gordon_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/gordon_SAaxis.csv")
schaefer200x7_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x7_SAaxis.csv")
schaefer200x7_SAaxis$label <- gsub("7Network", "Network", schaefer200x7_SAaxis$label)
schaefer200x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x17_SAaxis.csv")
schaefer200x17_SAaxis$label <- gsub("17Network", "Network", schaefer200x17_SAaxis$label)
schaefer200_SAaxis <- schaefer200x17_SAaxis
schaefer400x7_SAaxis  <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x7_SAaxis.csv")
schaefer400x7_SAaxis$label <-  gsub("7Networks", "Networks", schaefer400x7_SAaxis$label)
schaefer400x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x17_SAaxis.csv")
schaefer400x17_SAaxis$label <- gsub("17Network", "Network", schaefer400x17_SAaxis$label)
schaefer400_SAaxis <- schaefer400x17_SAaxis
#GBC - loads GBC.axis_glasser, GBC.axis_gordon, GBC.axis_schaefer200, GBC.axis_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#BNC - loads BNC.axis_gordon, BNC.axis_schaefer200x7, BNC.axis_schaefer200x17, BNC.axis_schaefer400x7, BNC.axis_schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#WNC - loads WNC.axis_gordon, WNC.axis_schaefer200x7, WNC.axis_schaefer200x17, WNC.axis_schaefer400x7, WNC.axis_schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#Load Spin Test Parcel Rotation Matrix
all_atlases <- c("glasser", "gordon","schaefer200x7","schaefer200x17", "schaefer400x7","schaefer400x17")
# parcel rotation matrices: perm.id.full_glasser, perm.id.full_gordon, perm.id.full_schaefer200x7, perm.id.full_schaefer200x17, perm.id.full_schaefer400x7, perm.id.full_schaefer400x17
for(i in c(1:length(all_atlases))){
df_name <- paste0("perm.id.full", "_", all_atlases[i])
assign(df_name, readRDS(sprintf("/cbica/projects/network_replication/software/rotate_parcellation/%1$s.coords_sphericalrotations_N10k.rds", all_atlases[i])))
print(paste(df_name, "made"))
}
# GBC - making df.dev.spin_GBC_glasser, df.dev.spin_GBC_gordon, df.dev.spin_GBC_schaefer200, df.dev.spin_GBC_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("df.dev.spin_", metric, "_", atlases_GBC[i])
assign(df_name, prepDfSpin(atlases_GBC[i], metric))
print(paste(df_name, "made"))
}
# BNC - making df.dev.spin_BNC_gordon, df.dev.spin_BNC_schaefer200x7, df.dev.spin_BNC_schaefer200x17, df.dev.spin_BNC_schaefer400x7, df.dev.spin_BNC_schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
df_name <- paste0("df.dev.spin_", metric, "_", atlases[i])
assign(df_name, prepDfSpin(atlases[i], metric))
print(paste(df_name, "made"))
}
# WNC - making df.dev.spin_WNC_gordon, df.dev.spin_WNC_schaefer200x7, df.dev.spin_WNC_schaefer200x17, df.dev.spin_WNC_schaefer400x7, df.dev.spin_WNC_schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
df_name <- paste0("df.dev.spin_", metric, "_", atlases[i])
assign(df_name, prepDfSpin(atlases[i], metric))
print(paste(df_name, "made"))
}
spearman_rho <- read.csv("/cbica/projects/network_replication/output/PNC/spearman_rho.csv")
pspin_vals <- readRDS("/cbica/projects/network_replication/output/PNC/pspin_vals.RData")
#GBC
#list(p_spin_GBC, p_spin_BNC, p_spin_WNC)
r_text_GBC.glasser <- expression(paste(italic("r"), " = -0.72, ",  , italic(p[spin]), "< 0.0001"))
(GBC_glasser <- gam_figure_p.spin(GBC.axis_glasser, "GBC", "Glasser", r_text_GBC.glasser,x_pos= 250, y_pos=0.12))
r_text_GBC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_gordon <- gam_figure_p.spin(GBC.axis_gordon, "GBC", "Gordon", r_text_GBC.gordon, x_pos= 250, y_pos=0.12))
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
r_text_GBC.schaefer400 <- expression(paste(italic("r"), "= -0.70, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer400 <- gam_figure_p.spin(GBC.axis_schaefer400, "GBC", "Schaefer400", r_text_GBC.schaefer400, x_pos= 300, y_pos=0.12))
#BNC
r_text_BNC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(BNC_gordon <- gam_figure_p.spin(BNC.axis_gordon, "BNC", "Gordon", r_text_BNC.gordon, x_pos= 270, y_pos=0.12))
r_text_BNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.67, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer200x7 <- gam_figure_p.spin(BNC.axis_schaefer200x7, "BNC", "schaefer200x7", r_text_BNC.schaefer200x7, x_pos= 150, y_pos=0.1))
r_text_BNC.schaefer200x17 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer200x17 <- gam_figure_p.spin(BNC.axis_schaefer200x17, "BNC", "schaefer200x17", r_text_BNC.schaefer200x17, x_pos= 150, y_pos=0.1))
r_text_BNC.schaefer400x7 <- expression(paste(italic("r"), "= -0.65, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer400x7 <- gam_figure_p.spin(BNC.axis_schaefer400x7, "BNC", "schaefer400x7", r_text_BNC.schaefer400x7, x_pos= 250, y_pos=0.1))
r_text_BNC.schaefer400x17 <- expression(paste(italic("r"), "= -0.69, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer400x17 <- gam_figure_p.spin(BNC.axis_schaefer400x17, "BNC", "schaefer400x17", r_text_BNC.schaefer400x17, x_pos= 250, y_pos=0.1))
#WNC
r_text_WNC.gordon <- expression(paste(italic("r"), "= -0.41, ",  , italic(p[spin]), "< 0.05"))
(WNC_gordon <- gam_figure_p.spin(WNC.axis_gordon, "WNC", "Gordon", r_text_WNC.gordon, x_pos= 250, y_pos=0.12))
r_text_WNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.47, ",  , italic(p[spin]), "< 0.01"))
(WNC_schaefer200x7 <- gam_figure_p.spin(WNC.axis_schaefer200x7, "WNC", "schaefer200x7", r_text_WNC.schaefer200x7, x_pos= 150, y_pos=0.1))
r_text_WNC.schaefer200x17 <- expression(paste(italic("r"), "= -0.43, ",  , italic(p[spin]), "< 0.05"))
(WNC_schaefer200x17 <- gam_figure_p.spin(WNC.axis_schaefer200x17, "WNC", "schaefer200x17", r_text_WNC.schaefer200x17, x_pos= 150, y_pos=0.1))
r_text_WNC.schaefer400x7 <- expression(paste(italic("r"), "= -0.48, ",  , italic(p[spin]), "< 0.01"))
(WNC_schaefer400x7 <- gam_figure_p.spin(WNC.axis_schaefer400x7, "WNC", "schaefer400x7", r_text_WNC.schaefer400x7, x_pos= 250, y_pos=0.1))
r_text_WNC.schaefer400x17 <- expression(paste(italic("r"), "= -0.44, ",  , italic(p[spin]), "< 0.01."))
(WNC_schaefer400x17 <- gam_figure_p.spin(WNC.axis_schaefer400x17, "WNC", "schaefer400x17", r_text_WNC.schaefer400x17, x_pos= 250, y_pos=0.1))
BNC_schaefer400x17
BNC_schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/Fig4_BNCAgeEffect_PNC_schaefer400x17.pdf", dpi=300, width = 5, height = 4)
WNC_schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/Fig4_WNCAgeEffect_PNC_schaefer400x17.pdf", dpi=300, width = 5, height = 4)
# makes devTraj.centered.glasser.GBC_df, devTraj.centered.gordon.GBC_df, devTraj.centered.schaefer200.GBC_df, devTraj.centered.schaefer400.GBC_df
metric="GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("devTraj.centered.", atlases_GBC[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases_GBC[i])))
print(df_name)
}
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
# devTraj.centered.gordon.BNC_df, devTraj.centered.schaefer200x7.BNC_df, devTraj.centered.schaefer200x17.BNC_df,  devTraj.centered.schaefer400x7.BNC_df, devTraj.centered.schaefer400x17.BNC_df
metric="BNC"
for(i in c(1:length(atlases))){
df_name <- paste0("devTraj.centered.", atlases[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases[i])))
print(df_name)
}
# devTraj.centered.gordon.WNC_df, devTraj.centered.schaefer200x7.WNC_df, devTraj.centered.schaefer200x17.WNC_df,  devTraj.centered.schaefer400x7.WNC_df, devTraj.centered.schaefer400x17.WNC_df
metric="WNC"
for(i in c(1:length(atlases))){
df_name <- paste0("devTraj.centered.", atlases[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases[i])))
print(df_name)
}
#GBC
devTraj.centered.GBC <- lapply(atlases_GBC, make_smooths_fig_centered, "GBC")
names(devTraj.centered.GBC) <- atlases_GBC
#BNC
devTraj.centered.BNC <- lapply(atlases, make_smooths_fig_centered, "BNC")
names(devTraj.centered.BNC) <- atlases
#WNC
devTraj.centered.WNC <- lapply(atlases, make_smooths_fig_centered, "WNC")
names(devTraj.centered.WNC) <- atlases
devTraj.centered.BNC$schaefer400x17
devTraj.centered.BNC$schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/martins/FigS4_BNCDevTraj_PNC.schaefer400x17.pdf", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/FigS4_BNCDevTraj_PNC.schaefer400x17.pdf", dpi=300, width = 5, height = 4)
devTraj.centered.WNC$schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/FigS4_WNCDevTraj_PNC.schaefer400x17.pdf", dpi=300, width = 5, height = 4)
devTraj.centered.WNC$schaefer400x17
devTraj.centered.WNC$schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/FigS4_WNCDevTraj_PNC.schaefer400x17.pdf", dpi=300, width = 5, height = 4)
make_smooths_fig_centered <- function(atlas, metric){
smooth_fits <- get(paste0("devTraj.centered.", atlas, ".", metric, "_df"))
smooths_fig_centered <- ggplot(smooth_fits,aes(age,est,group=SA.axis_rank)) +
geom_line(data = smooth_fits, size=.7, alpha = .6, aes(color=SA.axis_rank)) +
ggtitle(paste(metric, "-", atlas)) +
paletteer::scale_color_paletteer_c("grDevices::RdYlBu", direction = -1, limits = c(min(smooth_fits$SA.axis_rank), max(smooth_fits$SA.axis_rank)), oob = squish) +
theme_classic()
return(smooths_fig_centered)
}
devTraj.centered.WNC <- lapply(atlases, make_smooths_fig_centered, "WNC")
names(devTraj.centered.WNC) <- atlases
devTraj.centered.WNC$schaefer400x17
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/martins/FigS4_WNCDevTraj_PNC.schaefer400x17.pdf", dpi=300, width = 5, height = 4)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('PNC_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/DevEffect_Figures.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "PNC"
glasser_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/glasser_SAaxis.csv")
gordon_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/gordon_SAaxis.csv")
schaefer200x7_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x7_SAaxis.csv")
schaefer200x7_SAaxis$label <- gsub("7Network", "Network", schaefer200x7_SAaxis$label)
schaefer200x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x17_SAaxis.csv")
schaefer200x17_SAaxis$label <- gsub("17Network", "Network", schaefer200x17_SAaxis$label)
schaefer200_SAaxis <- schaefer200x17_SAaxis
schaefer400x7_SAaxis  <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x7_SAaxis.csv")
schaefer400x7_SAaxis$label <-  gsub("7Networks", "Networks", schaefer400x7_SAaxis$label)
schaefer400x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x17_SAaxis.csv")
schaefer400x17_SAaxis$label <- gsub("17Network", "Network", schaefer400x17_SAaxis$label)
schaefer400_SAaxis <- schaefer400x17_SAaxis
#GBC - loads gam.GBC.age.glasser, gam.GBC.age.gordon, gam.GBC.age.schaefer200, gam.GBC.age.schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("gam.", metric, ".", "age.", atlases_GBC[i])
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMresults.%2$s.age.%3$s.csv", dataset, metric, atlases_GBC[i])))
assign(df_name, get(df_name) %>% select(-label))
if(str_detect(atlases_GBC[i], "schaefer")) {
SAaxis <- get(paste0(atlases_GBC[i], "x17_", "SAaxis"))
} else {
SAaxis <- get(paste0(atlases_GBC[i], "_", "SAaxis"))
}
df_to.label <- get(df_name)
df_to.label$label <- SAaxis$label
assign(df_name, df_to.label)
}
#BNC - loads gam.BNC.age.gordon, gam.BNC.age.schaefer200x7, gam.BNC.age.schaefer400x7, gam.BNC.age.schaefer200x17, gam.BNC.age.schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
df_name <- paste0("gam.", metric, ".", "age.", atlases[i])
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMresults.%2$s.age.%3$s.csv", dataset, metric, atlases[i])))
assign(df_name, get(df_name) %>% select(-label))
SAaxis <- get(paste0(atlases[i], "_", "SAaxis"))
df_to.label <- get(df_name)
df_to.label$label <- SAaxis$label
assign(df_name, df_to.label)
}
#WNC - loads gam.WNC.age.gordon, gam.WNC.age.schaefer200x7, gam.WNC.age.schaefer400x7, gam.WNC.age.schaefer200x17, gam.WNC.age.schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
df_name <- paste0("gam.", metric, ".", "age.", atlases[i])
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMresults.%2$s.age.%3$s.csv", dataset, metric, atlases[i])))
assign(df_name, get(df_name) %>% select(-label))
SAaxis <- get(paste0(atlases[i], "_", "SAaxis"))
df_to.label <- get(df_name)
df_to.label$label <- SAaxis$label
assign(df_name, df_to.label)
}
#GBC - loads gam.GBC.derivatives.glasser, gam.GBC.derivatives.gordon, gam.GBC.derivatives.schaefer200, gam.GBC.derivatives.schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0("gam.", metric, ".derivatives.", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#BNC - loads gam.BNC.derivatives.gordon, gam.BNC.derivatives.schaefer200x7, gam.BNC.derivatives.schaefer400x7, gam.BNC.derivatives.schaefer200x17, gam.BNC.derivatives.schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
filename <- paste0("gam.", metric, ".derivatives.", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#WNC - loads gam.WNC.derivatives.gordon, gam.WNC.derivatives.schaefer200x7, gam.WNC.derivatives.schaefer400x7, gam.WNC.derivatives.schaefer200x17, gam.WNC.derivatives.schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
filename <- paste0("gam.", metric, ".derivatives.", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
# GBC - makes GBC.axis_glasser, GBC.axis_gordon, GBC.axis_schaefer200, GBC.axis_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0(metric, ".axis_", atlases_GBC[i])
assign(df_name, combineGAMdfs(metric, atlases_GBC[i]))
print(df_name)
}
GBC.axis_glasser <- sig_parcels(GBC.axis_glasser)
GBC.axis_gordon <- sig_parcels(GBC.axis_gordon)
GBC.axis_schaefer200 <- sig_parcels(GBC.axis_schaefer200)
GBC.axis_schaefer400 <- sig_parcels(GBC.axis_schaefer400)
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0(metric, ".axis_", atlases_GBC[i])
filename <- paste0(df_name)
#write.csv(get(filename), sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename))
print(df_name)
}
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0(metric, ".axis_", atlases_GBC[i])
filename <- paste0(df_name)
write.csv(get(filename), sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename))
print(df_name)
}
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
all_atlases <- c("glasser", "gordon","schaefer200x7","schaefer200x17", "schaefer400x7","schaefer400x17")
# parcel rotation matrices: perm.id.full_glasser, perm.id.full_gordon, perm.id.full_schaefer200x7, perm.id.full_schaefer200x17, perm.id.full_schaefer400x7, perm.id.full_schaefer400x17
for(i in c(1:length(all_atlases))){
df_name <- paste0("perm.id.full", "_", all_atlases[i])
assign(df_name, readRDS(sprintf("/cbica/projects/network_replication/software/rotate_parcellation/%1$s.coords_sphericalrotations_N10k.rds", all_atlases[i])))
print(paste(df_name, "made"))
}
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("df.dev.spin_", metric, "_", atlases_GBC[i])
assign(df_name, prepDfSpin(atlases_GBC[i], metric))
print(paste(df_name, "made"))
}
ageEffect_GBC.fig <- lapply(atlases_GBC, ageEffect_surf_figure, "GBC")
names(ageEffect_GBC.fig) <- atlases_GBC
plot_grid(ageEffect_GBC.fig$gordon, ageEffect_GBC.fig$schaefer200, ageEffect_GBC.fig$glasser,ageEffect_GBC.fig$schaefer400,labels = "AUTO")
plot_grid(ageEffect_BNC.fig$gordon, ageEffect_BNC.fig$schaefer200x7, ageEffect_BNC.fig$schaefer200x17, ageEffect_BNC.fig$schaefer400x7, ageEffect_BNC.fig$schaefer400x17, labels = "AUTO")
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("corr.", metric, "_", atlases_GBC[i])
axis <- get(paste0(metric, ".axis_", atlases_GBC[i]))
assign(df_name, cor.test(axis$GAM.age.AdjRsq, as.numeric(axis$SA.axis_rank), method=c("spearman"), exact=F)$estimate)
print(paste(df_name, "made"))
}
spearman_rho <- data.frame(cbind(corr.GBC_glasser, corr.GBC_gordon, corr.GBC_schaefer200, corr.GBC_schaefer400))
write.csv(spearman_rho, "/cbica/projects/network_replication/output/PNC/spearman_rho.csv")
# spin permutation tests:
metric = "GBC"
p_spin_GBC <- c()
for(i in c(1:length(atlases_GBC))){
df.dev.spin <- get(paste0("df.dev.spin_", metric, "_", atlases_GBC[i]))
if(str_detect(atlases_GBC[i], "schaefer")) {
perm.id.full <- get(paste0("perm.id.full_", atlases_GBC[i], "x17"))
} else {
perm.id.full <- get(paste0("perm.id.full_", atlases_GBC[i]))
}
p_spin_atlas <- perm.sphere.p(as.numeric(df.dev.spin$GAM.age.AdjRsq), as.numeric(df.dev.spin$SA.axis_rank), perm.id.full, corr.type='spearman')
p_spin_GBC <- append(p_spin_GBC, p_spin_atlas)
print(paste(atlases_GBC[i], p_spin_atlas))
}
p_spin_GBC <- data.frame(cbind(atlases_GBC, p_spin_GBC))
saveRDS(list(p_spin_GBC), "/cbica/projects/network_replication/output/PNC/pspin_vals.RData")
spearman_rho <- read.csv("/cbica/projects/network_replication/output/PNC/spearman_rho.csv")
pspin_vals <- readRDS("/cbica/projects/network_replication/output/PNC/pspin_vals.RData")
spearman_rho
pspin_vals
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 160, y_pos=0.12))
GBC_schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCAgeEffect_PNC.pdf", dpi=300, width = 5, height = 4)
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
GBC_schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCAgeEffect_PNC.pdf", dpi=300, width = 5, height = 4)
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("gam.smooths.", atlases_GBC[i], ".", metric)
assign(df_name, make_gam.smooths(metric, atlases_GBC[i], dataset))
print(df_name)
}
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("devTraj.centered.", atlases_GBC[i], ".", metric, "_df")
assign(df_name, make_gam.smooths_centered(metric, atlases_GBC[i], dataset)) #commenting out to prevent make_gam.smooths_centered from making new csv's each time you run code
print(df_name)
}
metric="GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("devTraj.centered.", atlases_GBC[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases_GBC[i])))
print(df_name)
}
devTraj.centered.GBC <- lapply(atlases_GBC, make_smooths_fig_centered, "GBC")
names(devTraj.centered.GBC) <- atlases_GBC
devTraj.centered.GBC$schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCDevTraj_PNC.pdf", dpi=300, width = 5, height = 4)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('PNC_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/DevEffect_Figures.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "PNC"
