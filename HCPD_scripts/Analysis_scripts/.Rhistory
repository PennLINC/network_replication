smooths_repParcels <- function(SA_ranks, atlas_name, metric){
gam.smooths.centered <- get(paste0("devTraj.centered.", atlas_name, ".", metric, "_df"))
gam.smooths.ordered <- gam.smooths.centered[order(gam.smooths.centered$SA.axis_rank),]
parcel_rows <- which(gam.smooths.ordered$SA.axis_rank %in% SA_ranks) # trying to extract all rows that match SA_ranks
repParcels <- gam.smooths.ordered[parcel_rows,]
return(repParcels)
}
names(schaefer200x7_SAaxis)[3] <- "label"
# schaefer200x7
## extract row numbers for parcels of interest (somatomotor, default, visual, salient/ventral attention, and frontal parietal networks)
## note that all 7 Network schaefer atlas parcels have been reordered to match 17 network (see schaefer7to17_reordering.Rmd)
## arrange(schaefer200x7_SAaxis, by= SA.axis_rank)
SM <- which(str_detect(schaefer200x7_SAaxis$label, "SomMot")) # mean SA rank = 40
SM_ranks <- schaefer200x7_SAaxis$SA.axis_rank[SM] # somatomotor is pretty uniform in terms of all increasing; auditory too though there are some U shaped curves
visual <- which(str_detect(schaefer200x7_SAaxis$label, "Vis")) # mean SA rank = 30
visual_ranks <- schaefer200x7_SAaxis$SA.axis_rank[visual]
default <- which(str_detect(schaefer200x7_SAaxis$label, "Default")) # mean SA rank = 155
default_ranks <- schaefer200x7_SAaxis$SA.axis_rank[default]
attention <- which(str_detect(schaefer200x7_SAaxis$label, "SalVentAttn")) # mean SA rank = 113
attention_ranks <- schaefer200x7_SAaxis$SA.axis_rank[attention]
frontoparietalControl <- which(str_detect(schaefer200x7_SAaxis$label, "Cont")) # mean SA rank = 144
frontoparietalControl_ranks <- schaefer200x7_SAaxis$SA.axis_rank[frontoparietalControl]
schaefer200x7_parcelRanks <- list(SM_ranks, visual_ranks, default_ranks, attention_ranks, frontoparietalControl_ranks)
repParcels_GBC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200", "GBC")
names(repParcels_GBC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_BNC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200x7", "BNC")
names(repParcels_BNC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_WNC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200x7", "WNC")
names(repParcels_WNC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_schaefer200x7 <- list(repParcels_GBC_schaefer200x7, repParcels_BNC_schaefer200x7, repParcels_WNC_schaefer200x7)
names(repParcels_schaefer200x7) <- c("GBC", "BNC", "WNC")
## set up dataframe for making figures
schaefer200x7_SAaxis$SA.axis_rank <- as.numeric(schaefer200x7_SAaxis$SA.axis_rank)
names(schaefer200x7_SAaxis)[3] <- "region"
schaefer200x7_SAaxis_fig.df <- schaefer200x7_SAaxis %>% mutate(SomMot = ifelse(SA.axis_rank %in% SM_ranks, 1, 0)) %>%
mutate(default = ifelse(SA.axis_rank %in% default_ranks, 1, 0))  %>%
mutate(attention = ifelse(SA.axis_rank %in% attention_ranks, 1, 0)) %>%
mutate(visual = ifelse(SA.axis_rank %in% visual_ranks, 1, 0)) %>%
mutate(frontoparietalControl = ifelse(SA.axis_rank %in% frontoparietalControl_ranks, 1, 0))
schaefer200x7_SAaxis_fig.df$region <- gsub("Network", "7Network", schaefer200x7_SAaxis_fig.df$region)
# schaefer200x7
## somatomotor parcels: average SA rank = 39.5
schaefer200x7_GBC_SomMot <- make_repParcel.fig("GBC", "schaefer200x7", "SomMot", "#24A6A8FF")
schaefer200x7_BNC_SomMot <- make_repParcel.fig("BNC", "schaefer200x7",  "SomMot", "#24A6A8FF")
schaefer200x7_WNC_SomMot <- make_repParcel.fig("WNC", "schaefer200x7",  "SomMot", "#24A6A8FF")
schaefer200x7_SomMot <- list(schaefer200x7_GBC_SomMot, schaefer200x7_BNC_SomMot, schaefer200x7_WNC_SomMot)
names(schaefer200x7_SomMot) <- c("GBC", "BNC", "WNC")
## default parcels: average SA rank = 155
schaefer200x7_GBC_default <- make_repParcel.fig("GBC", "schaefer200x7", "default", "#C73000FF")
schaefer200x7_BNC_default <- make_repParcel.fig("BNC", "schaefer200x7",  "default", "#C73000FF")
schaefer200x7_WNC_default <- make_repParcel.fig("WNC", "schaefer200x7",  "default", "#C73000FF")
schaefer200x7_default <- list(schaefer200x7_GBC_default, schaefer200x7_BNC_default, schaefer200x7_WNC_default)
names(schaefer200x7_default) <- c("GBC", "BNC", "WNC")
## frontoparietalControl network parcels: average SA rank = 143
schaefer200x7_GBC_frontoparietalControl <- make_repParcel.fig("GBC", "schaefer200x7", "frontoparietalControl", "#C73000FF")
schaefer200x7_BNC_frontoparietalControl <- make_repParcel.fig("BNC", "schaefer200x7",  "frontoparietalControl", "#C73000FF")
schaefer200x7_WNC_frontoparietalControl <- make_repParcel.fig("WNC", "schaefer200x7",  "frontoparietalControl", "#C73000FF")
schaefer200x7_frontoparietalControl <- list(schaefer200x7_GBC_frontoparietalControl, schaefer200x7_BNC_frontoparietalControl, schaefer200x7_WNC_frontoparietalControl)
names(schaefer200x7_frontoparietalControl) <- c("GBC", "BNC", "WNC")
## attention network parcels: average SA rank = 113
schaefer200x7_GBC_attention <- make_repParcel.fig("GBC", "schaefer200x7", "attention", "#EEAC32FF")
schaefer200x7_BNC_attention <- make_repParcel.fig("BNC", "schaefer200x7",  "attention", "#EEAC32FF")
schaefer200x7_WNC_attention <- make_repParcel.fig("WNC", "schaefer200x7",  "attention", "#EEAC32FF")
schaefer200x7_attention <- list(schaefer200x7_GBC_attention, schaefer200x7_BNC_attention, schaefer200x7_WNC_attention)
names(schaefer200x7_attention) <- c("GBC", "BNC", "WNC")
schaefer200x7_SomMot$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_SM_NKI.pdf", dpi=300, width = 5, height = 5)
schaefer200x7_attention$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_Attention_NKI.pdf", dpi=300, width = 5, height = 5)
schaefer200x7_default$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_Default_NKI.pdf", dpi=300, width = 5, height = 5)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('PNC_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/sensitivity_analyses/DevEffect_Figures_restOnly.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "PNC"
glasser_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/glasser_SAaxis.csv")
gordon_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/gordon_SAaxis.csv")
schaefer200x7_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x7_SAaxis.csv")
schaefer200x7_SAaxis$label <- gsub("7Network", "Network", schaefer200x7_SAaxis$label)
schaefer200x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x17_SAaxis.csv")
schaefer200x17_SAaxis$label <- gsub("17Network", "Network", schaefer200x17_SAaxis$label)
schaefer200_SAaxis <- schaefer200x17_SAaxis
schaefer400x7_SAaxis  <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x7_SAaxis.csv")
schaefer400x7_SAaxis$label <-  gsub("7Networks", "Networks", schaefer400x7_SAaxis$label)
schaefer400x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x17_SAaxis.csv")
schaefer400x17_SAaxis$label <- gsub("17Network", "Network", schaefer400x17_SAaxis$label)
schaefer400_SAaxis <- schaefer400x17_SAaxis
#GBC - loads GBC.axis_glasser, GBC.axis_gordon, GBC.axis_schaefer200, GBC.axis_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
r_text_GBC.glasser <- expression(paste(italic("r"), " = -0.72, ",  , italic(p[spin]), "< 0.0001"))
(GBC_glasser <- gam_figure_p.spin(GBC.axis_glasser, "GBC", "Glasser", r_text_GBC.glasser,x_pos= 270, y_pos=0.12))
r_text_GBC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_gordon <- gam_figure_p.spin(GBC.axis_gordon, "GBC", "Gordon", r_text_GBC.gordon, x_pos= 270, y_pos=0.12))
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
r_text_GBC.schaefer400 <- expression(paste(italic("r"), "= -0.70, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer400 <- gam_figure_p.spin(GBC.axis_schaefer400, "GBC", "Schaefer400", r_text_GBC.schaefer400, x_pos= 260, y_pos=0.12))
GBC_schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCAgeEffect_PNC.pdf", dpi=300, width = 5, height = 5)
# makes devTraj.centered.glasser.GBC_df, devTraj.centered.gordon.GBC_df, devTraj.centered.schaefer200.GBC_df, devTraj.centered.schaefer400.GBC_df
metric="GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("devTraj.centered.", atlases_GBC[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases_GBC[i])))
print(df_name)
}
devTraj.centered.GBC <- lapply(atlases_GBC, make_smooths_fig_centered, "GBC")
names(devTraj.centered.GBC) <- atlases_GBC
devTraj.centered.GBC$schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCDevTraj_PNC.pdf", dpi=300, width = 5, height = 5)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCDevTraj_PNC.pdf", dpi=300, width = 5, height = 5)
make_smooths_fig_centered <- function(atlas, metric){
smooth_fits <- get(paste0("devTraj.centered.", atlas, ".", metric, "_df"))
smooths_fig_centered <- ggplot(smooth_fits,aes(age,est,group=SA.axis_rank)) +
geom_line(data = smooth_fits, size=.7, alpha = .6, aes(color=SA.axis_rank)) +
ggtitle(paste(metric, "-", atlas)) + ylim(-0.035, 0.055) + ylab("Predicted Global Brain Connectivity") + xlab("Age") +
paletteer::scale_color_paletteer_c("grDevices::RdYlBu", direction = -1, limits = c(min(smooth_fits$SA.axis_rank), max(smooth_fits$SA.axis_rank)), oob = squish) +
theme(
axis.title.x=element_text(size=18, color = "black"),
axis.title.y=element_text(size=18, color = "black"),
axis.line = element_line(color = "black"),
axis.text=element_text(size=20, color = "black"),
panel.background=element_blank(),
legend.position = "none")
return(smooths_fig_centered)
}
devTraj.centered.GBC <- lapply(atlases_GBC, make_smooths_fig_centered, "GBC")
names(devTraj.centered.GBC) <- atlases_GBC
devTraj.centered.GBC$schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCDevTraj_PNC.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$glasser
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.glasser.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$gordon
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.gordon.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
GBC_glasser
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.glasser.pdf", dpi=300, width = 5, height = 5)
GBC_gordon
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.gordon.pdf", dpi=300, width = 5, height = 5)
GBC_schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
r_text_GBC.glasser <- expression(paste(italic("r"), " = -0.72, ",  , italic(p[spin]), "< 0.0001"))
(GBC_glasser <- gam_figure_p.spin(GBC.axis_glasser, "GBC", "Glasser", r_text_GBC.glasser,x_pos= 270, y_pos=0.12))
r_text_GBC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_gordon <- gam_figure_p.spin(GBC.axis_gordon, "GBC", "Gordon", r_text_GBC.gordon, x_pos= 270, y_pos=0.12))
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
r_text_GBC.schaefer400 <- expression(paste(italic("r"), "= -0.70, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer400 <- gam_figure_p.spin(GBC.axis_schaefer400, "GBC", "Schaefer400", r_text_GBC.schaefer400, x_pos= 300, y_pos=0.12))
GBC_glasser
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.glasser.pdf", dpi=300, width = 5, height = 5)
GBC_gordon
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.gordon.pdf", dpi=300, width = 5, height = 5)
GBC_schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('PNC_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/DevEffect_Figures.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "PNC"
glasser_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/glasser_SAaxis.csv")
gordon_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/gordon_SAaxis.csv")
schaefer200x7_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x7_SAaxis.csv")
schaefer200x7_SAaxis$label <- gsub("7Network", "Network", schaefer200x7_SAaxis$label)
schaefer200x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x17_SAaxis.csv")
schaefer200x17_SAaxis$label <- gsub("17Network", "Network", schaefer200x17_SAaxis$label)
schaefer200_SAaxis <- schaefer200x17_SAaxis
schaefer400x7_SAaxis  <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x7_SAaxis.csv")
schaefer400x7_SAaxis$label <-  gsub("7Networks", "Networks", schaefer400x7_SAaxis$label)
schaefer400x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x17_SAaxis.csv")
schaefer400x17_SAaxis$label <- gsub("17Network", "Network", schaefer400x17_SAaxis$label)
schaefer400_SAaxis <- schaefer400x17_SAaxis
#GBC - loads GBC.axis_glasser, GBC.axis_gordon, GBC.axis_schaefer200, GBC.axis_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#BNC - loads BNC.axis_gordon, BNC.axis_schaefer200x7, BNC.axis_schaefer200x17, BNC.axis_schaefer400x7, BNC.axis_schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#WNC - loads WNC.axis_gordon, WNC.axis_schaefer200x7, WNC.axis_schaefer200x17, WNC.axis_schaefer400x7, WNC.axis_schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
r_text_GBC.glasser <- expression(paste(italic("r"), " = -0.72, ",  , italic(p[spin]), "< 0.0001"))
(GBC_glasser <- gam_figure_p.spin(GBC.axis_glasser, "GBC", "Glasser", r_text_GBC.glasser,x_pos= 250, y_pos=0.12))
r_text_GBC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_gordon <- gam_figure_p.spin(GBC.axis_gordon, "GBC", "Gordon", r_text_GBC.gordon, x_pos= 250, y_pos=0.12))
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
r_text_GBC.schaefer400 <- expression(paste(italic("r"), "= -0.70, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer400 <- gam_figure_p.spin(GBC.axis_schaefer400, "GBC", "Schaefer400", r_text_GBC.schaefer400, x_pos= 300, y_pos=0.12))
GBC_schaefer200
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/GBC_schaefer200.svg", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig3/Fig3_GBCAgeEffect_PNC.pdf", dpi=300, width = 5, height = 5)
GBC_glasser
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.glasser.pdf", dpi=300, width = 5, height = 5)
GBC_gordon
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.gordon.pdf", dpi=300, width = 5, height = 5)
GBC_schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
#BNC
r_text_BNC.gordon <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(BNC_gordon <- gam_figure_p.spin(BNC.axis_gordon, "BNC", "Gordon", r_text_BNC.gordon, x_pos= 270, y_pos=0.12))
r_text_BNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.67, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer200x7 <- gam_figure_p.spin(BNC.axis_schaefer200x7, "BNC", "schaefer200x7", r_text_BNC.schaefer200x7, x_pos= 150, y_pos=0.1))
r_text_BNC.schaefer200x17 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer200x17 <- gam_figure_p.spin(BNC.axis_schaefer200x17, "BNC", "schaefer200x17", r_text_BNC.schaefer200x17, x_pos= 150, y_pos=0.1))
r_text_BNC.schaefer400x7 <- expression(paste(italic("r"), "= -0.65, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer400x7 <- gam_figure_p.spin(BNC.axis_schaefer400x7, "BNC", "schaefer400x7", r_text_BNC.schaefer400x7, x_pos= 250, y_pos=0.1))
r_text_BNC.schaefer400x17 <- expression(paste(italic("r"), "= -0.69, ",  , italic(p[spin]), "< 0.0001"))
(BNC_schaefer400x17 <- gam_figure_p.spin(BNC.axis_schaefer400x17, "BNC", "schaefer400x17", r_text_BNC.schaefer400x17, x_pos= 250, y_pos=0.1))
#WNC
r_text_WNC.gordon <- expression(paste(italic("r"), "= -0.41, ",  , italic(p[spin]), "< 0.05"))
(WNC_gordon <- gam_figure_p.spin(WNC.axis_gordon, "WNC", "Gordon", r_text_WNC.gordon, x_pos= 250, y_pos=0.12))
r_text_WNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.47, ",  , italic(p[spin]), "< 0.01"))
(WNC_schaefer200x7 <- gam_figure_p.spin(WNC.axis_schaefer200x7, "WNC", "schaefer200x7", r_text_WNC.schaefer200x7, x_pos= 150, y_pos=0.1))
r_text_WNC.schaefer200x17 <- expression(paste(italic("r"), "= -0.43, ",  , italic(p[spin]), "< 0.05"))
(WNC_schaefer200x17 <- gam_figure_p.spin(WNC.axis_schaefer200x17, "WNC", "schaefer200x17", r_text_WNC.schaefer200x17, x_pos= 150, y_pos=0.1))
r_text_WNC.schaefer400x7 <- expression(paste(italic("r"), "= -0.48, ",  , italic(p[spin]), "< 0.01"))
(WNC_schaefer400x7 <- gam_figure_p.spin(WNC.axis_schaefer400x7, "WNC", "schaefer400x7", r_text_WNC.schaefer400x7, x_pos= 250, y_pos=0.1))
r_text_WNC.schaefer400x17 <- expression(paste(italic("r"), "= -0.44, ",  , italic(p[spin]), "< 0.01."))
(WNC_schaefer400x17 <- gam_figure_p.spin(WNC.axis_schaefer400x17, "WNC", "schaefer400x17", r_text_WNC.schaefer400x17, x_pos= 250, y_pos=0.1))
BNC_schaefer200x7
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/BNC_schaefer200x17.svg", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_BNCAgeEffect_PNC.pdf", dpi=300, width = 6, height = 5)
WNC_schaefer200x7
#ggsave("/cbica/projects/network_replication/output/Figures/Flux/WNC_schaefer200x17.svg", dpi=300)
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/WNC_schaefer200x17.svg", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_WNCAgeEffect_PNC.pdf", dpi=300, width = 6, height = 5)
# makes devTraj.centered.glasser.GBC_df, devTraj.centered.gordon.GBC_df, devTraj.centered.schaefer200.GBC_df, devTraj.centered.schaefer400.GBC_df
metric="GBC"
for(i in c(1:length(atlases_GBC))){
df_name <- paste0("devTraj.centered.", atlases_GBC[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases_GBC[i])))
print(df_name)
}
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
# devTraj.centered.gordon.BNC_df, devTraj.centered.schaefer200x7.BNC_df, devTraj.centered.schaefer200x17.BNC_df,  devTraj.centered.schaefer400x7.BNC_df, devTraj.centered.schaefer400x17.BNC_df
metric="BNC"
for(i in c(1:length(atlases))){
df_name <- paste0("devTraj.centered.", atlases[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases[i])))
print(df_name)
}
# devTraj.centered.gordon.WNC_df, devTraj.centered.schaefer200x7.WNC_df, devTraj.centered.schaefer200x17.WNC_df,  devTraj.centered.schaefer400x7.WNC_df, devTraj.centered.schaefer400x17.WNC_df
metric="WNC"
for(i in c(1:length(atlases))){
df_name <- paste0("devTraj.centered.", atlases[i], ".", metric, "_df")
assign(df_name, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/GAMsmoothfits.%2$s.age.%3$s_centered.csv", dataset, metric, atlases[i])))
print(df_name)
}
devTraj.centered.GBC <- lapply(atlases_GBC, make_smooths_fig_centered, "GBC")
names(devTraj.centered.GBC) <- atlases_GBC
devTraj.centered.GBC$schaefer200
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/GBC_schaefer200_devTraj.svg", dpi=300, width = 4, height = 3)
#ggsave("/cbica/projects/network_replication/output/Figures/Flux/devTraj.centered.GBC_fig.svg", dpi=300)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTraj_PNC.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$glasser
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.glasser.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$gordon
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.gordon.pdf", dpi=300, width = 5, height = 5)
devTraj.centered.GBC$schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCDevTraj_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
# subsets gam.smooths (long_df) to extract specific parcels and creates a new dataframe (to make dev trajectory figures)
# @param SA_parcelnames, A character string indicating which parcels to plot (i.e "SM", "default", etc.; may be different for different atlases)
smooths_repParcels <- function(SA_ranks, atlas_name, metric){
gam.smooths.centered <- get(paste0("devTraj.centered.", atlas_name, ".", metric, "_df"))
gam.smooths.ordered <- gam.smooths.centered[order(gam.smooths.centered$SA.axis_rank),]
parcel_rows <- which(gam.smooths.ordered$SA.axis_rank %in% SA_ranks) # trying to extract all rows that match SA_ranks
repParcels <- gam.smooths.ordered[parcel_rows,]
return(repParcels)
}
names(schaefer200x7_SAaxis)[3] <- "label"
# schaefer200x7
## extract row numbers for parcels of interest (somatomotor, default, visual, salient/ventral attention, and frontal parietal networks)
## note that all 7 Network schaefer atlas parcels have been reordered to match 17 network (see schaefer7to17_reordering.Rmd)
## arrange(schaefer200x7_SAaxis, by= SA.axis_rank)
SM <- which(str_detect(schaefer200x7_SAaxis$label, "SomMot")) # mean SA rank = 40
SM_ranks <- schaefer200x7_SAaxis$SA.axis_rank[SM] # somatomotor is pretty uniform in terms of all increasing; auditory too though there are some U shaped curves
visual <- which(str_detect(schaefer200x7_SAaxis$label, "Vis")) # mean SA rank = 30
visual_ranks <- schaefer200x7_SAaxis$SA.axis_rank[visual]
default <- which(str_detect(schaefer200x7_SAaxis$label, "Default")) # mean SA rank = 155
default_ranks <- schaefer200x7_SAaxis$SA.axis_rank[default]
attention <- which(str_detect(schaefer200x7_SAaxis$label, "SalVentAttn")) # mean SA rank = 113
attention_ranks <- schaefer200x7_SAaxis$SA.axis_rank[attention]
frontoparietalControl <- which(str_detect(schaefer200x7_SAaxis$label, "Cont")) # mean SA rank = 144
frontoparietalControl_ranks <- schaefer200x7_SAaxis$SA.axis_rank[frontoparietalControl]
schaefer200x7_parcelRanks <- list(SM_ranks, visual_ranks, default_ranks, attention_ranks, frontoparietalControl_ranks)
repParcels_GBC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200", "GBC")
names(repParcels_GBC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_BNC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200x7", "BNC")
names(repParcels_BNC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_WNC_schaefer200x7 <- lapply(schaefer200x7_parcelRanks, smooths_repParcels, "schaefer200x7", "WNC")
names(repParcels_WNC_schaefer200x7) <- c("SomMot", "visual", "default", "attention", "frontoparietalControl")
repParcels_schaefer200x7 <- list(repParcels_GBC_schaefer200x7, repParcels_BNC_schaefer200x7, repParcels_WNC_schaefer200x7)
names(repParcels_schaefer200x7) <- c("GBC", "BNC", "WNC")
## set up dataframe for making figures
schaefer200x7_SAaxis$SA.axis_rank <- as.numeric(schaefer200x7_SAaxis$SA.axis_rank)
names(schaefer200x7_SAaxis)[3] <- "region"
schaefer200x7_SAaxis_fig.df <- schaefer200x7_SAaxis %>% mutate(SomMot = ifelse(SA.axis_rank %in% SM_ranks, 1, 0)) %>%
mutate(default = ifelse(SA.axis_rank %in% default_ranks, 1, 0))  %>%
mutate(attention = ifelse(SA.axis_rank %in% attention_ranks, 1, 0)) %>%
mutate(visual = ifelse(SA.axis_rank %in% visual_ranks, 1, 0)) %>%
mutate(frontoparietalControl = ifelse(SA.axis_rank %in% frontoparietalControl_ranks, 1, 0))
schaefer200x7_SAaxis_fig.df$region <- gsub("Network", "7Network", schaefer200x7_SAaxis_fig.df$region)
# schaefer200x7
## somatomotor parcels: average SA rank = 39.5
schaefer200x7_GBC_SomMot <- make_repParcel.fig("GBC", "schaefer200x7", "SomMot", "#24A6A8FF")
schaefer200x7_BNC_SomMot <- make_repParcel.fig("BNC", "schaefer200x7",  "SomMot", "#24A6A8FF")
schaefer200x7_WNC_SomMot <- make_repParcel.fig("WNC", "schaefer200x7",  "SomMot", "#24A6A8FF")
schaefer200x7_SomMot <- list(schaefer200x7_GBC_SomMot, schaefer200x7_BNC_SomMot, schaefer200x7_WNC_SomMot)
names(schaefer200x7_SomMot) <- c("GBC", "BNC", "WNC")
## default parcels: average SA rank = 155
schaefer200x7_GBC_default <- make_repParcel.fig("GBC", "schaefer200x7", "default", "#C73000FF")
schaefer200x7_BNC_default <- make_repParcel.fig("BNC", "schaefer200x7",  "default", "#C73000FF")
schaefer200x7_WNC_default <- make_repParcel.fig("WNC", "schaefer200x7",  "default", "#C73000FF")
schaefer200x7_default <- list(schaefer200x7_GBC_default, schaefer200x7_BNC_default, schaefer200x7_WNC_default)
names(schaefer200x7_default) <- c("GBC", "BNC", "WNC")
## frontoparietalControl network parcels: average SA rank = 143
schaefer200x7_GBC_frontoparietalControl <- make_repParcel.fig("GBC", "schaefer200x7", "frontoparietalControl", "#C73000FF")
schaefer200x7_BNC_frontoparietalControl <- make_repParcel.fig("BNC", "schaefer200x7",  "frontoparietalControl", "#C73000FF")
schaefer200x7_WNC_frontoparietalControl <- make_repParcel.fig("WNC", "schaefer200x7",  "frontoparietalControl", "#C73000FF")
schaefer200x7_frontoparietalControl <- list(schaefer200x7_GBC_frontoparietalControl, schaefer200x7_BNC_frontoparietalControl, schaefer200x7_WNC_frontoparietalControl)
names(schaefer200x7_frontoparietalControl) <- c("GBC", "BNC", "WNC")
## attention network parcels: average SA rank = 113
schaefer200x7_GBC_attention <- make_repParcel.fig("GBC", "schaefer200x7", "attention", "#EEAC32FF")
schaefer200x7_BNC_attention <- make_repParcel.fig("BNC", "schaefer200x7",  "attention", "#EEAC32FF")
schaefer200x7_WNC_attention <- make_repParcel.fig("WNC", "schaefer200x7",  "attention", "#EEAC32FF")
schaefer200x7_attention <- list(schaefer200x7_GBC_attention, schaefer200x7_BNC_attention, schaefer200x7_WNC_attention)
names(schaefer200x7_attention) <- c("GBC", "BNC", "WNC")
schaefer200x7_SomMot$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_SM_PNC.pdf", dpi=300, width = 5, height = 5)
schaefer200x7_attention$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_Attention_PNC.pdf", dpi=300, width = 5, height = 5)
schaefer200x7_default$GBC
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig2/Fig2_GBCDevTrajRep_Default_PNC.pdf", dpi=300, width = 5, height = 5)
#GBC - loads GBC.axis_glasser, GBC.axis_gordon, GBC.axis_schaefer200, GBC.axis_schaefer400
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/sensitivity_analyses/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.71, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
GBC_schaefer200
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS3_GBCAgeEffect_PNC.pdf", dpi=300, width = 5, height = 5)
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
r_text_GBC.schaefer400 <- expression(paste(italic("r"), "= -0.70, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer400 <- gam_figure_p.spin(GBC.axis_schaefer400, "GBC", "Schaefer400", r_text_GBC.schaefer400, x_pos= 320, y_pos=0.12))
GBC_schaefer400
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Supplementary/FigS4_GBCAgeEffect_PNC.schaefer400.pdf", dpi=300, width = 5, height = 5)
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s_covbat.csv", dataset, metric, filename)))
print(filename)
}
dataset
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s_covbat.csv", dataset, metric, filename)))
print(filename)
}
dataset="HCPD"
metric = "GBC"
for(i in c(1:length(atlases_GBC))){
filename <- paste0(metric, ".axis_", atlases_GBC[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s_covbat.csv", dataset, metric, filename)))
print(filename)
}
r_text_GBC.schaefer200 <- expression(paste(italic("r"), "= -0.67, ",  , italic(p[spin]), "< 0.0001"))
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 130, y_pos=0.12))
GBC_schaefer200
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/GBC_schaefer200_HCPD.svg", dpi=300, width = 5, height = 4)
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/harmonization/HCPD_GBCAgeEffect_Covbat.pdf", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig3/Fig3_GBCAgeEffect_HCPD_Covbat.pdf", dpi=300, width = 5, height = 5)
(GBC_schaefer200 <- gam_figure_p.spin(GBC.axis_schaefer200, "GBC", "Schaefer200", r_text_GBC.schaefer200, x_pos= 150, y_pos=0.12))
GBC_schaefer200
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Figures/OHBM_2023/GBC_schaefer200_HCPD.svg", dpi=300, width = 5, height = 4)
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/harmonization/HCPD_GBCAgeEffect_Covbat.pdf", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig3/Fig3_GBCAgeEffect_HCPD_Covbat.pdf", dpi=300, width = 5, height = 5)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
require(ggplot2)
library(cowplot)
library(cifti)
library(ggseg)
Sys.setenv(RGL_USE_NULL=TRUE)
library(ggsegExtra)
library(ggsegSchaefer)
library(ggsegGlasser)
library(ggsegGordon)
library(ggcorrplot)
library(viridis)
library(scales)
library(stringr)
library(tidyr)
library(ggpubr)
library(purrr)
library(pammtools)
#load('NKI_devEffectFigures_environment.RData')
source("/cbica/projects/network_replication/adapted_Rscripts/DevEffect_Figures.R")
source("/cbica/projects/network_replication/adapted_Rscripts/netrep_spinTests.R")
source("/cbica/projects/network_replication/software/perm.sphere.p.R")
atlases_GBC <- c("glasser", "gordon", "schaefer200", "schaefer400")
atlases <- c("gordon", "schaefer200x7", "schaefer200x17", "schaefer400x7", "schaefer400x17")
dataset <- "NKI"
glasser_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/glasser_SAaxis.csv")
gordon_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/gordon_SAaxis.csv")
schaefer200x7_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x7_SAaxis.csv")
schaefer200x7_SAaxis$label <- gsub("7Network", "Network", schaefer200x7_SAaxis$label)
schaefer200x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer200x17_SAaxis.csv")
schaefer200x17_SAaxis$label <- gsub("17Network", "Network", schaefer200x17_SAaxis$label)
schaefer200_SAaxis <- schaefer200x17_SAaxis
schaefer400x7_SAaxis  <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x7_SAaxis.csv")
schaefer400x7_SAaxis$label <-  gsub("7Networks", "Networks", schaefer400x7_SAaxis$label)
schaefer400x17_SAaxis <- read.csv("/cbica/projects/network_replication/SAaxis/schaefer400x17_SAaxis.csv")
schaefer400x17_SAaxis$label <- gsub("17Network", "Network", schaefer400x17_SAaxis$label)
schaefer400_SAaxis <- schaefer400x17_SAaxis
#BNC - loads BNC.axis_gordon, BNC.axis_schaefer200x7, BNC.axis_schaefer200x17, BNC.axis_schaefer400x7, BNC.axis_schaefer400x17
metric = "BNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
#WNC - loads WNC.axis_gordon, WNC.axis_schaefer200x7, WNC.axis_schaefer200x17, WNC.axis_schaefer400x7, WNC.axis_schaefer400x17
metric = "WNC"
for(i in c(1:length(atlases))){
filename <- paste0(metric, ".axis_", atlases[i])
assign(filename, read.csv(sprintf("/cbica/projects/network_replication/output/%1$s/%2$s/GAM/%3$s.csv", dataset, metric, filename)))
print(filename)
}
r_text_BNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.47, ",  , italic(p[spin]), "< 0.001"))
(BNC_schaefer200x7 <- gam_figure_p.spin(BNC.axis_schaefer200x7, "BNC", "schaefer200x7", r_text_BNC.schaefer200x7, x_pos= 150, y_pos=0.1))
r_text_WNC.schaefer200x7 <- expression(paste(italic("r"), "= -0.27, ",  , italic(p[spin]), "< 0.05"))
(WNC_schaefer200x7 <- gam_figure_p.spin(WNC.axis_schaefer200x7, "WNC", "schaefer200x7", r_text_WNC.schaefer200x7, x_pos= 150, y_pos=0.12))
BNC_schaefer200x7
#BNC_schaefer200x17
#ggsave("/cbica/projects/network_replication/output/Figures/Flux/BNC_schaefer200x17.svg", dpi=300)
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_BNCAgeEffect_NKI.pdf", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_BNCAgeEffect_NKI.pdf", dpi=300, width = 6, height = 5)
WNC_schaefer200x7
#ggsave("/cbica/projects/network_replication/output/Figures/Flux/WNC_schaefer200x17.svg", dpi=300)
#ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_WNCAgeEffect_NKI.pdf", dpi=300, width = 5, height = 4)
ggsave("/Users/audluo/Library/CloudStorage/Box-Box/Box_PhD_Land/PennLINC/network_replication/Writing/Manuscript/Figures/Fig4/Fig4_WNCAgeEffect_NKI.pdf", dpi=300, width = 6, height = 5)
